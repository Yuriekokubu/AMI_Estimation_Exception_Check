<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESTIMATION EXCEPTION WONDERLAND</title>
    <link rel="icon" type="image/x-icon" href="images/alice.ico">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.0/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Mali:wght@400;700&family=Poppins:wght@300;500;700&display=swap"
        rel="stylesheet">
    <style>
        /* BASE STYLES */
        body {
            font-family: 'Poppins', 'Mali', sans-serif;
            background-color: #b0c8e658;
            background-image: url('images/alice3.jpg');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        /* FORM CONTAINER - ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ñ‡∏≤‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö */
        .form-container {
            position: relative;
            background-color: rgba(255, 255, 255, 0.792);
            padding: 60px;
            border-radius: 18px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            width: 100%;
            text-align: center;
            animation: fadeIn 0.8s ease-out;
            margin-top: 30px;

            background-image: none;
            border: 5px solid #d45f78;
            outline: 5px solid white;
            outline-offset: 10px;

            /* ‡πÄ‡∏û‡∏¥‡πà‡∏° transition ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏î‡∏π‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏Ç‡∏∂‡πâ‡∏ô */
            transition: all 0.5s ease-in-out;
        }

        /* NEW: ‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ã‡πà‡∏≠‡∏ô Form Container */
        .form-container.hide-form {
            opacity: 0;
            transform: scale(0.9);
            /* ‡∏¢‡πà‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
            max-height: 0;
            padding-top: 0;
            padding-bottom: 0;
            overflow: hidden;
            border-width: 0;
            outline: 0;
            margin-top: 0;
            margin-bottom: 0;
        }

        /* NEW: ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° Toggle (Fixed Position) */
        #toggleButton {
            position: fixed;
            /* ‡∏¢‡∏∂‡∏î‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ */
            top: 20px;
            /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏à‡∏≠ */
            right: 20px;
            /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏à‡∏≠ */
            width: auto;
            /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° */
            padding: 8px 15px;
            background-color: #1a73e800;
            /* ‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô */
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 50px;
            font-weight: 500;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s, transform 0.3s;
            z-index: 100;
            /* ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á */
        }

        #toggleButton:hover {
            background-color: #0b5bc300;
            transform: scale(1.05);
        }

        /* NEW: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ Form ‡πÄ‡∏õ‡πá‡∏ô relative ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ Pseudo-elements ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏°‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ */
        #meterForm {
            position: relative;
            /* ‡πÄ‡∏û‡∏¥‡πà‡∏° transition ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô/‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏î‡∏π‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏Ç‡∏∂‡πâ‡∏ô */
            transition: opacity 0.3s ease-in-out;
        }

        /* NEW: ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ñ‡∏π‡∏Å‡∏ã‡πà‡∏≠‡∏ô ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÉ‡∏ô Form-container ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢ */
        .form-container.hide-form h2,
        .form-container.hide-form #meterForm,
        .form-container.hide-form .result,
        .form-container.hide-form .summary {
            display: none;
        }


        /* NEW: ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏£‡πà‡∏ß‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Pseudo-elements ‡∏ó‡∏±‡πâ‡∏á 4 ‡∏°‡∏∏‡∏° (‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡∏•‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà) */
        .form-container::before,
        .form-container::after,
        #meterForm::before,
        #meterForm::after {
            content: '';
            position: absolute;
            width: 300px;
            height: 300px;
            background-size: contain;
            background-repeat: no-repeat;
            z-index: 10;
            pointer-events: none;
            /* ‡πÄ‡∏û‡∏¥‡πà‡∏° transition ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ñ‡∏≤‡∏ß‡∏±‡∏•‡∏¢‡πå */
            transition: opacity 0.5s ease-in-out;
        }

        /* NEW: ‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏ñ‡∏≤‡∏ß‡∏±‡∏•‡∏¢‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠ Form ‡∏ñ‡∏π‡∏Å‡∏ã‡πà‡∏≠‡∏ô */
        .form-container.hide-form::before,
        .form-container.hide-form::after,
        .form-container.hide-form #meterForm::before,
        .form-container.hide-form #meterForm::after {
            opacity: 0;
        }

        /* 1. ‡∏°‡∏∏‡∏°‡∏ö‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ (Top Left Rose) */
        .form-container::before {
            top: -50px;
            left: -60px;
            background-image: url('images/rose_top_left2.png');
        }

        /* 2. ‡∏°‡∏∏‡∏°‡∏ö‡∏ô‡∏Ç‡∏ß‡∏≤ (Top Right Rose) */
        .form-container::after {
            top: -75px;
            right: -75px;
            background-image: url('images/rose_top_right.png');
        }

        /* 3. ‡∏°‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ (Bottom Left Rose) - ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å #meterForm */
        #meterForm::before {
            bottom: -75px;
            left: -75px;
            background-image: url('images/rose_bottom_left.png');
        }

        /* 4. ‡∏°‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏ß‡∏≤ (Cheshire Cat) - ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å #meterForm */
        #meterForm::after {
            bottom: -80px;
            right: -250px;
            background-image: url('images/cat.webp');
            width: 350px;
            height: 350px;
            transition: all 1s ease-in-out;
        }

        /* ** FIX: CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏°‡∏ß‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏•‡∏á‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ñ‡∏≤‡∏ß‡∏£ ** */
        #meterForm.cat-final-position::after {
            /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏°‡∏≤ 400px ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏û‡∏≤‡πÅ‡∏°‡∏ß‡∏•‡∏á‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ï‡πâ Summary ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ */
            transform: translateY(350px) scale(1);
            opacity: 1;
        }

        /* ================================================= */
        /* === CHESHIRE CAT SPEECH BUBBLE EFFECT === */
        /* ================================================= */

        /* Speech Bubble Container */
        .cheshire-speech {
            position: absolute;
            bottom: 130px;
            right: -200px;
            width: 150px;
            padding: 10px;
            background: #ffcce5;
            /* ‡∏™‡∏µ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô */
            border-radius: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            font-size: 14px;
            font-weight: 700;
            color: #b700ff;
            /* ‡∏™‡∏µ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô */
            text-align: center;
            opacity: 0.9;
            z-index: 20;
            transition: all 1s ease-in-out, transform 0.5s ease-in-out;
            /* ‡πÄ‡∏û‡∏¥‡πà‡∏° transform transition */
            /* ‡πÅ‡∏≠‡∏ô‡∏¥‡πÄ‡∏°‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô */
            animation:
                blink-text 1s infinite alternate,
                float-up 2s ease-in-out infinite;
        }

        /* Speech Bubble Pointer (‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡πÅ‡∏°‡∏ß) */
        .cheshire-speech::before {
            content: '';
            position: absolute;
            bottom: -10px;
            right: 70px;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid #ffcce5;
            transition: border-top 0.3s ease-in-out;
        }


        /* ** CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏û‡∏π‡∏î "Thank you!" ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏ñ‡∏≤‡∏ß‡∏£ (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à) ** */
        .cheshire-speech.speech-final-position {
            /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏°‡∏≤ 250px ‡πÄ‡∏°‡∏∑‡πà‡∏≠ Form ‡∏ñ‡∏π‡∏Å‡∏Ç‡∏¢‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å */
            transform: translateY(250px);
            opacity: 1;
            /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Thank You */
            background: #ffe351;
            color: #5a1467;
            border: 2px solid #5a1467;
            /* ‡∏•‡∏ö animation ‡∏•‡∏≠‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏á */
            animation: none;
            /* ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡∏≤‡∏°‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡πÅ‡∏°‡∏ß‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß */
            bottom: 10px;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏û‡∏π‡∏î Thank You */
        .cheshire-speech.speech-final-position::before {
            border-top: 10px solid #ffe351;
        }

        /* ** NEW: CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö) ** */
        .cheshire-speech.speech-warning {
            background: #d93025;
            /* ‡∏™‡∏µ‡πÅ‡∏î‡∏á */
            color: white;
            border: 2px solid white;
            animation: bounce-once 2s ease-out 1;
            /* ‡πÄ‡∏î‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô */
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏µ‡πâ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô */
        .cheshire-speech.speech-warning::before {
            border-top: 10px solid #d93025;
        }

        /* Animation: Floating */
        @keyframes float-up {
            0% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-5px);
            }

            100% {
                transform: translateY(0px);
            }
        }

        /* NEW: Animation: Bounce Once (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô) */
        @keyframes bounce-once {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        /* ================================================= */

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            margin-bottom: 30px;
            font-size: 32px;
            color: #d44d4a;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.05);
        }

        /* GRID LAYOUT FOR INPUTS (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) */
        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px 30px;
            margin-bottom: 25px;
        }

        .form-row.full-width {
            grid-column: 1 / -1;
        }

        label {
            font-size: 15px;
            font-weight: 500;
            color: #333;
            display: block;
            margin-bottom: 8px;
            text-align: left;
        }

        /* INPUT FIELDS (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) */
        input[type="date"],
        textarea {
            width: 100%;
            min-height: 45px;
            padding: 10px 15px;
            border: 1px solid #c8d1da;
            border-radius: 10px;
            font-size: 16px;
            color: #333;
            box-sizing: border-box;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        #meterid,
        #estimation {
            height: 150px;
            resize: vertical;
            font-family: 'Poppins', sans-serif;
        }

        /* ‡∏Å‡∏£‡∏≠‡∏ö‡∏™‡∏µ‡∏ä‡∏°‡∏û‡∏π‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà */
        input[required]:invalid:not(:focus),
        textarea[required]:invalid:not(:focus) {
            border-color: #ff6b81;
            /* ‡∏™‡∏µ‡πÅ‡∏î‡∏á‡∏≠‡∏°‡∏ä‡∏°‡∏û‡∏π‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô */
            box-shadow: 0 0 0 3px rgba(255, 107, 129, 0.3);
        }

        input[type="date"]:focus,
        textarea:focus {
            border-color: #1a73e8;
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
            outline: none;
            background-color: #ffffff;
        }

        /* RADIO BUTTONS (ROUND) (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) */
        .radio-group {
            display: flex;
            gap: 25px;
            align-items: center;
            padding-top: 5px;
        }

        .radio-group label {
            display: inline-flex;
            align-items: center;
            margin-bottom: 0;
            cursor: pointer;
            font-weight: 400;
            transition: color 0.3s;
        }

        input[type="radio"] {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #aab6c4;
            border-radius: 50%;
            margin-right: 8px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
        }

        input[type="radio"]:checked {
            border-color: #1a73e8;
        }

        input[type="radio"]:checked::after {
            content: '';
            width: 12px;
            height: 12px;
            background: #1a73e8;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
        }

        /* BUTTON (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) */
        button {
            width: 100%;
            padding: 16px 20px;
            background-color: #d44d4a;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 19px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(69, 10, 86, 0.3);
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        button:hover {
            background-color: #de1d8d;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(26, 115, 232, 0.3);
        }

        /* RESULTS / SUMMARY (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á) */
        .result,
        .summary {
            margin-top: 30px;
            padding: 25px;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            background-color: #f7f9fc;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }

        .result.show,
        .summary.show {
            opacity: 1;
            transform: translateY(0);
            display: block !important;
        }

        .summary h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #1a73e8;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 8px;
        }

        .summary p {
            margin: 10px 0;
            font-size: 16px;
        }

        .result p.error {
            color: #d93025;
            font-weight: 500;
        }

        /* RESPONSIVE DESIGN (Media Queries) */
        @media (max-width: 768px) {
            .form-container {
                padding: 25px;
                margin-top: 10px;

                /* ‡∏•‡∏ö‡πÄ‡∏ñ‡∏≤‡∏ß‡∏±‡∏•‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏Ç‡∏≠‡∏ö‡∏≠‡∏≠‡∏Å‡πÉ‡∏ô‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
                background-image: none;
                border: none;
                outline: none;
                box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
                /* ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ Shadow ‡πÅ‡∏ó‡∏ô */
            }

            /* NEW: ‡∏ã‡πà‡∏≠‡∏ô‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏°‡∏ß‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
            .form-container::before,
            .form-container::after,
            #meterForm::before,
            #meterForm::after,
            .cheshire-speech {
                display: none !important;
            }

            h2 {
                font-size: 26px;
            }

            .input-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .form-row.full-width {
                grid-column: auto;
            }

            .radio-group {
                flex-direction: row;
                justify-content: flex-start;
            }

            #meterid,
            #estimation {
                height: 120px;
            }
        }
    </style>
</head>

<body>

    <button id="toggleButton" onclick="toggleFormVisibility()">üê∞</button>

    <div class="form-container">
        <h2>‚ú® Estimation Exception Wonderland</h2>
        <form id="meterForm" novalidate>
            <div class="cheshire-speech">
                Where are the Exceptions?
            </div>

            <div class="input-grid">

                <div class="form-row">
                    <label for="meterid">MeterID :</label>
                    <textarea id="meterid" name="meterid" required></textarea>
                </div>

                <div class="form-row">
                    <label for="estimation">Estimation :</label>
                    <textarea id="estimation" name="estimation" required></textarea>
                </div>

                <div class="form-row">
                    <label for="date">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                    <input type="date" id="date" name="date" required>
                </div>

                <div class="form-row">
                    <label>Round: </label>
                    <div class="radio-group">
                        <input type="radio" id="round1" name="round" value="01" checked> <label for="round1">Round
                            1</label>
                        <input type="radio" id="round2" name="round" value="02"> <label for="round2">Round 2</label>
                    </div>
                </div>

            </div>

            <button type="submit">‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Excel</button>
        </form>

        <div id="result" class="result" style="display: none;"></div>
        <div id="summary" class="summary" style="display: none;"></div>
    </div>

    <script>
        // NEW: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        function toggleFormVisibility() {
            const container = document.querySelector('.form-container');
            const button = document.getElementById('toggleButton');

            // ‡πÉ‡∏ä‡πâ classList.toggle ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏ö‡∏Ñ‡∏•‡∏≤‡∏™ 'hide-form'
            container.classList.toggle('hide-form');

            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
            if (container.classList.contains('hide-form')) {
                button.textContent = 'üé©';
            } else {
                button.textContent = 'üê∞';
            }
        }

        document.getElementById("meterForm").addEventListener("submit", function (event) {
            event.preventDefault();

            const meterForm = document.getElementById("meterForm");
            const speechBubble = document.querySelector('.cheshire-speech');

            // --- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏° (Validation Check) ---
            if (!meterForm.checkValidity()) {

                // 1. ‡∏ñ‡πâ‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÑ‡∏°‡πà‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå (‡∏°‡∏µ required field ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà)

                // ‡∏•‡∏ö class ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏≠‡∏≠‡∏Å ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô
                speechBubble.classList.remove('speech-final-position');
                meterForm.classList.remove('cat-final-position');

                // ‡πÄ‡∏û‡∏¥‡πà‡∏° class ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                speechBubble.textContent = "Oops! Missing required fields!";
                speechBubble.classList.add('speech-warning');

                // ‡∏•‡∏ö class ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏™‡∏î‡∏á animation ‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å
                setTimeout(() => {
                    speechBubble.classList.remove('speech-warning');
                    speechBubble.textContent = "Where are the Exceptions?"; // ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°
                }, 3000);

                // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Process Logic
                return;
            }

            // --- 2. ‡∏ñ‡πâ‡∏≤‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏•‡πâ‡∏ß (Success Logic) ---

            // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏û‡∏π‡∏î (Success)
            speechBubble.textContent = "Thank you! ‚ù§Ô∏è";
            speechBubble.classList.remove('speech-warning'); // ‡∏•‡∏ö warning ‡∏≠‡∏≠‡∏Å
            speechBubble.classList.add('speech-final-position');

            // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏°‡∏ß‡∏•‡∏á‡πÑ‡∏õ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
            meterForm.classList.add('cat-final-position');


            // --- 3. Process Logic ---
            const meterIDInput = document.getElementById("meterid").value;
            const estimationInput = document.getElementById("estimation").value || "";
            const date = document.getElementById("date").value;
            const round = document.querySelector('input[name="round"]:checked').value;

            // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà
            let meterIDs = meterIDInput.split(/\s+/).filter(Boolean);
            let estimations = estimationInput.split(/\s+/).filter(Boolean);

            const resultDiv = document.getElementById("result");
            const summaryDiv = document.getElementById("summary");

            resultDiv.innerHTML = "";
            summaryDiv.innerHTML = "";
            resultDiv.classList.remove('show');
            summaryDiv.classList.remove('show');
            summaryDiv.style.display = "block"; // ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÉ‡∏´‡∏°‡πà

            const worksheetData = [["MeterID", "Status"]];
            let exceptionCount = 0;
            let estimationCount = 0;

            meterIDs.forEach((meterID) => {
                let status = "EXCEPTION";
                if (estimations.includes(meterID)) {
                    status = "ESTIMATION";
                    estimationCount++;
                } else {
                    exceptionCount++;
                }
                worksheetData.push([meterID, status]);
            });

            // Summary (English)
            summaryDiv.innerHTML = `
                <h3>Summary</h3>
                <p>All exception files: ${meterIDs.length}</p>
                <p>All estimation files: ${estimations.length}</p>
                <p>----------------------</p>
                <p>- exception = ${exceptionCount}</p>
                <p>- estimation = ${estimationCount}</p>
            `;

            setTimeout(() => {
                summaryDiv.classList.add('show');
                summaryDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);

            try {
                const worksheet = XLSX.utils.aoa_to_sheet(worksheetData);
                const workbook = XLSX.utils.book_new();
                const formattedDate = date.split("-").reverse().join("");
                let sheetName = `${formattedDate}_EST_EXP_${round}`;

                if (sheetName.length > 31) {
                    sheetName = sheetName.slice(0, 31);
                }

                XLSX.utils.book_append_sheet(workbook, worksheet, sheetName);
                XLSX.writeFile(workbook, `${sheetName}.xlsx`);
            } catch (error) {
                const errorRow = document.createElement('p');
                errorRow.textContent = `‚ö†Ô∏è Error generating Excel file: ${error.message}`;
                errorRow.classList.add('error');
                resultDiv.appendChild(errorRow);

                setTimeout(() => {
                    resultDiv.classList.add('show');
                }, 100);
            }
        });
    </script>
</body>

</html>